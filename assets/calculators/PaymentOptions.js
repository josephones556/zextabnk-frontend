KJE.PaymentOptionsCalc=function(){this.iDecimalsRound=KJE.parameters.get("DECIMALS_ROUND",2);this.MSG_ERROR1=KJE.parameters.get("MSG_ERROR1","Interest rate must be greater than or equal to zero.");this.INTEREST_ONLY="Interest only";this.MSG_YEAR_NUMBER="Year Number";this.MSG_PRINCIPAL="Principal";this.MSG_INTEREST="Interest";this.MSG_PAYMENT_NUMBER="Payment Number";this.MSG_PRINCIPAL_BALANCE="Principal Balance";this.MSG_PREPAYMENTS="Prepayments";this.MSG_NORMAL_PAYMENTS="Normal payments";this.MSG_PREPAY_MESSAGE="Your planned prepayment(s) will shorten your mortgage by PREPAY_SHORTEN_YEARS years and PREPAY_SHORTEN_MONTHS months.";this.MSG_RETURN_AMOUNT="A monthly payment of MONTHLY_PI at INTEREST_RATE for TERM years will give you a mortgage amount of LOAN_AMOUNT.";this.MSG_RETURN_PAYMENT="A loan amount of LOAN_AMOUNT at INTEREST_RATE for TERM years will give you a monthly payment (PI) of MONTHLY_PI.";this.MSG_GRAPH_COL1="Normal";this.MSG_GRAPH_COL2="Prepay";this.MSG_ERROR_BALLOON="Loan term must be less than the amortization term.";this.MSG_TITLE1=KJE.parameters.get("MSG_TITLE1","Payment is KJE1 per month");this.MSG_TITLE2=KJE.parameters.get("MSG_TITLE2","Amount borrowed is KJE1");this.PAYMENT_PERCENT_PRINCIPAL1=KJE.parameters.get("PAYMENT_PERCENT_PRINCIPAL1",5);this.PAYMENT_PERCENT_PRINCIPAL2=KJE.parameters.get("PAYMENT_PERCENT_PRINCIPAL2",5.5);this.PAYMENT_PERCENT_PRINCIPAL3=KJE.parameters.get("PAYMENT_PERCENT_PRINCIPAL3",6);this.PAYMENT_PERCENT_INTEREST=KJE.parameters.get("PAYMENT_PERCENT_INTEREST",100);this.INTEREST_ONLY=KJE.parameters.get("MSG_PAYMENT_PERCENT_INTEREST",KJE.number(this.PAYMENT_PERCENT_INTEREST)+KJE.PaymentOptionsCalc.MSG_PAYMENT_CHOICE[1]);this.MSG_TITLE="";this.BY_YEAR=0;this.TERM=0;this.PAYMENT_CALC=true;this.PERCENT_PAYMENT=0;this.PAYMENT_OPTION=this.TRADITIONAL;this.ENDING_BALANCE=0;this.AMOUNT_DOWN_PAYMENT=0;this.PERCENT_DOWN_PAYMENT=0;this.PURCHASE_PRICE=0;this.PRE_TOTAL_OF_PAYMENTS=0;this.PRE_INTEREST_PAID=0;this.PRE_INTEREST_SAVINGS=0;this.PRE_ENDING_BALANCE=0;this.PREPAY_STARTS_WITH=0;this.PREPAY_AMOUNT=0;this.PREPAY_TYPE=KJE.PaymentOptionsCalc.PREPAY_NONE;this.LOAN_TYPE_LABEL="";this.LOAN_TYPE_MSG="";this.bPrepayment=true;this.DS_BALANCE=null;this.DS_PREPAY_BALANCE=null;this.cats=null;this.sSchedule=new KJE.Repeating()};KJE.PaymentOptionsCalc.prototype.clear=function(){this.MONTHLY_PAYMENT=0;this.INTEREST_RATE=0;this.LOAN_AMOUNT=0;this.TAX_RATE=0};KJE.PaymentOptionsCalc.prototype.calculate=function(F){var l=KJE;var r=this.MONTHLY_PAYMENT;var g=this.INTEREST_RATE;var B=this.LOAN_AMOUNT;var D=this.TAX_RATE;var d=0;var c=0;var v=0;var p=0;var s=this.BY_YEAR;var h=!(this.PREPAY_TYPE==(KJE.PaymentOptionsCalc.PREPAY_NONE)||KJE.PaymentOptionsCalc.PREPAY_AMOUNT<=0);if(this.PREPAY_STARTS_WITH==0){this.PREPAY_STARTS_WITH=1}if(g<0){throw (this.MSG_ERROR1)}if(this.PURCHASE_PRICE>0){B=Math.round(this.PURCHASE_PRICE*(1-this.PERCENT_DOWN_PAYMENT/100));this.AMOUNT_DOWN_PAYMENT=this.PURCHASE_PRICE-B}if(this.PAYMENT_OPTION==KJE.PaymentOptionsCalc.PERCENT_BALANCE){this.LOAN_TYPE_MSG=KJE.PaymentOptionsCalc.MSG_TYPE_TEXT[KJE.PaymentOptionsCalc.PERCENT_BALANCE];if(!this.PAYMENT_CALC){B=l.round(r/(this.PERCENT_PAYMENT/100),0)}else{r=l.round(B*(this.PERCENT_PAYMENT/100),this.iDecimalsRound)}}else{if(this.PAYMENT_OPTION==KJE.PaymentOptionsCalc.PERCENT_INTEREST){this.LOAN_TYPE_MSG=KJE.PaymentOptionsCalc.MSG_TYPE_TEXT[KJE.PaymentOptionsCalc.PERCENT_INTEREST];if(!this.PAYMENT_CALC){B=l.round(r/((this.PERCENT_PAYMENT/100)*(g/1200)),0)}else{r=l.round(l.round((g/1200)*B,2)*(this.PERCENT_PAYMENT/100),this.iDecimalsRound)}}else{this.LOAN_TYPE_MSG=KJE.PaymentOptionsCalc.MSG_TYPE_TEXT[KJE.PaymentOptionsCalc.TRADITIONAL];if(!this.PAYMENT_CALC){B=Math.round(KJE.PV(g/1200,this.TERM,r))}else{r=l.round(KJE.PMT(g/1200,this.TERM,B),this.iDecimalsRound)}}}if(!this.PAYMENT_CALC){this.MSG_TITLE=KJE.getKJEReplaced(this.MSG_TITLE2,l.dollars(B,2))}else{this.MSG_TITLE=KJE.getKJEReplaced(this.MSG_TITLE1,l.dollars(r,2))}var u=Math.round(this.TERM);var C=0;var t=u;if(u>=120){t=Math.ceil(u/12)}this.DS_BALANCE=KJE.FloatArray(t);this.DS_PREPAY_BALANCE=KJE.FloatArray(t);this.cats=new Array(t);if(F){var m=this.sSchedule;m.clearRepeat();if(h){m.addHeader("&nbsp;",{sCell:KJE._sHeadingUnderline,sContent:m.sReportCol("Regular Payment Schedule",10),sFormat:"COLSPAN=3"},{sCell:KJE._sHeadingUnderline,sContent:m.sReportCol("Additional Principal Payments Schedule",11),sFormat:"COLSPAN=3"})}if(!s&&h){m.addHeader(m.sReportCol("<BR><BR>Nbr",1),m.sReportCol("<BR><BR>Payment",2),m.sReportCol("<BR><BR>Interest",4),m.sReportCol("Ending<BR>Principal<BR>Balance",5),m.sReportCol("<BR><BR>Payment",2),m.sReportCol("<BR><BR>Interest",4),m.sReportCol("Ending<BR>Principal<BR>Balance",5))}else{if(!s&&!h){m.addHeader(m.sReportCol("<BR><BR>Nbr",1),m.sReportCol("<BR><BR>Payment",2),m.sReportCol("<BR><BR>Principal",3),m.sReportCol("<BR><BR>Interest",4),m.sReportCol("Ending<BR>Principal<BR>Balance",5))}else{if(s&&h){m.addHeader(m.sReportCol("<BR><BR>Yr ",6),m.sReportCol("<BR>Total<BR>Payments",7),m.sReportCol("<BR>Interest<BR>Paid",8),m.sReportCol("Ending<BR>Principal<BR>Balance",5),m.sReportCol("<BR>Total<BR>Payments",7),m.sReportCol("<BR>Interest<BR>Paid",8),m.sReportCol("Ending<BR>Principal<BR>Balance",5))}else{m.addHeader(m.sReportCol("<BR><BR>Year",6),m.sReportCol("<BR>Total<BR>Payments",7),m.sReportCol("<BR>Principal<BR>Paid",9),m.sReportCol("<BR>Interest<BR>Paid",8),m.sReportCol("Ending<BR>Principal<BR>Balance",5))}}}if(h){m.addRepeat("&nbsp;","&nbsp;","&nbsp;",l.dollars(B,2),(this.PREPAY_TYPE==KJE.PaymentOptionsCalc.PREPAY_ONETIME&&this.PREPAY_STARTS_WITH==0?l.dollars(this.PREPAY_AMOUNT,2):""),"&nbsp;","&nbsp;",l.dollars(a,2))}else{m.addRepeat("&nbsp;","&nbsp;","&nbsp;","&nbsp;",l.dollars(B,2))}}var a=B;var E=0;var H=0;var k=r;var b=0;var f=0;this.ENDING_BALANCE=0;var A=B;var G=B;var e=0;var w=0;var o=0;this.PRE_TOTAL_OF_PAYMENTS=0;this.PRE_INTEREST_PAID=0;this.PRE_ENDING_BALANCE=0;var j=0;if(D>0){j=D/100}var x=0;var y=true;for(var z=1;z<=u;z++){C=z-1;if(u>=120){y=((C%12)==0)}else{y=true}o=0;if(h&&(this.PREPAY_STARTS_WITH<=z)){if(this.PREPAY_TYPE==KJE.Default.PREPAY_ONETIME&&(this.PREPAY_STARTS_WITH==z)){o=this.PREPAY_AMOUNT}else{if(this.PREPAY_TYPE==KJE.Default.PREPAY_YEARLY){if(((z-this.PREPAY_STARTS_WITH)%12)==0){o=this.PREPAY_AMOUNT}}else{if(this.PREPAY_TYPE==(KJE.Default.PREPAY_MONTHLY)){o=this.PREPAY_AMOUNT}}}}E=l.round((g/1200)*a,this.iDecimalsRound);e=l.round((g/1200)*A,this.iDecimalsRound);if(this.PAYMENT_OPTION==KJE.PaymentOptionsCalc.PERCENT_BALANCE){k=l.round(a*(this.PERCENT_PAYMENT/100),this.iDecimalsRound);H=k-E;a-=H;if(a<0){H+=a;a=0}if(A==0){w=0;G=0;A=0}else{G=l.round(A*(this.PERCENT_PAYMENT/100),this.iDecimalsRound);w=G-e;A-=w;if(A<0){w+=A;A=0}}}else{if(this.PAYMENT_OPTION==KJE.PaymentOptionsCalc.PERCENT_INTEREST){H=0;k=l.round(E*(this.PERCENT_PAYMENT/100),this.iDecimalsRound);a=a+E-k;if(A==0){w=0;G=0;A=0}else{w=o;G=l.round(e*(this.PERCENT_PAYMENT/100),this.iDecimalsRound)+o;A=A+e-G;if(A<0){w+=A;A=0}}}else{H=r-E;a-=H;if(a<0){k+=a;a=0;H=k-E}else{k=r}if(u==z){if(a>0.005){k+=a;a=0;H=k-E}else{a=0}}w=r+o-e;A-=w;if(A<0){G+=A;A=0;w=G-e}else{G=r+o}if(u==z){if(A>0.005){G+=A;A=0;w=G-e}else{A=0}}}}b+=k;f+=E;this.PRE_TOTAL_OF_PAYMENTS+=G;this.PRE_INTEREST_PAID+=e;d+=l.round(E*(j),this.iDecimalsRound);if(z==1){c=l.round(f*(j),this.iDecimalsRound);p=k-c}if(z<=12){v+=l.round(E*(j),this.iDecimalsRound)}if(y){if(u>=120){this.cats[x]=""+Math.floor((z+12)/12)}else{this.cats[x]=""+z}this.DS_BALANCE[x]=(a);this.DS_PREPAY_BALANCE[x]=(A);x++}if(!s&&F){if(h){m.addRepeat(l.number(z),l.dollars(k,2),l.dollars(E,2),l.dollars(a,2),l.dollars(G,2),l.dollars(e,2),l.dollars(A,2))}else{m.addRepeat(l.number(z),l.dollars(k,2),l.dollars(H,2),l.dollars(E,2),l.dollars(a,2))}}}this.ENDING_BALANCE=a;this.PRE_ENDING_BALANCE=A;this.PRE_INTEREST_SAVINGS=f-this.PRE_INTEREST_PAID;this.INTEREST_PAID=f;this.TOTAL_OF_PAYMENTS=b;this.TAX_REDUCTION_TOTAL=d;this.TAX_REDUCTION_PER_PERIOD=c;this.TAX_REDUCTION_FIRST_YEAR=v;this.AFTER_TAX_NET_PAYMENT=p;this.bPrepayment=h;this.MONTHLY_PAYMENT=r;this.LOAN_AMOUNT=B;this.LOAN_TYPE_LABEL=KJE.PaymentOptionsCalc.MSG_TYPE_LABEL[this.PAYMENT_OPTION]};KJE.PaymentOptionsCalc.prototype.formatReport=function(b){var c=KJE;var a=this.iDecimal;var d=b;if(this.PREPAY_TYPE==(KJE.Default.PREPAY_NONE)){d=KJE.replace("PREPAY_TYPE",this.PREPAY_TYPE,d);d=KJE.replace("PREPAY_TOTAL_OF_PAYMENTS","",d);d=KJE.replace("PREPAY_STARTS_WITH","",d);d=KJE.replace("PREPAY_INTEREST_SAVINGS","",d);d=KJE.replace("PREPAY_INTEREST_PAID","",d);d=KJE.replace("PREPAY_AMOUNT","",d);d=KJE.replace("PREPAY_ENDING_BALANCE","",d)}else{d=KJE.replace("PREPAY_TYPE",KJE.Default.PREPAY_PERIODS[this.PREPAY_TYPE],d);d=KJE.replace("PREPAY_TOTAL_OF_PAYMENTS",c.dollars(this.PRE_TOTAL_OF_PAYMENTS,2),d);d=KJE.replace("PREPAY_STARTS_WITH",c.number(this.PREPAY_STARTS_WITH),d);d=KJE.replace("PREPAY_INTEREST_SAVINGS",c.dollars(this.PRE_INTEREST_SAVINGS,2),d);d=KJE.replace("PREPAY_INTEREST_PAID",c.dollars(this.PRE_INTEREST_PAID,2),d);d=KJE.replace("PREPAY_AMOUNT",c.dollars(this.PREPAY_AMOUNT,2),d);d=KJE.replace("PREPAY_ENDING_BALANCE",c.dollars(this.PRE_ENDING_BALANCE,2),d)}d=KJE.replace("LOAN_TYPE_MSG",this.LOAN_TYPE_MSG,d);d=KJE.replace("LOAN_TYPE_LABEL",this.LOAN_TYPE_LABEL,d);d=KJE.replace("MONTHLY_PAYMENT",c.dollars(this.MONTHLY_PAYMENT,2),d);d=KJE.replace("INTEREST_RATE",c.percent(this.INTEREST_RATE/100,2),d);d=KJE.replace("TERM",c.number(this.TERM),d);d=KJE.replace("LOAN_AMOUNT",c.dollars(this.LOAN_AMOUNT,2),d);d=KJE.replace("TAX_RATE",c.percent(this.TAX_RATE/100,2),d);d=KJE.replace("TAX_REDUCTION_TOTAL",c.dollars(this.TAX_REDUCTION_TOTAL,2),d);d=KJE.replace("TAX_REDUCTION_PER_PERIOD",c.dollars(this.TAX_REDUCTION_PER_PERIOD,2),d);d=KJE.replace("TAX_REDUCTION_FIRST_YEAR",c.dollars(this.TAX_REDUCTION_FIRST_YEAR,2),d);d=KJE.replace("AFTER_TAX_NET_PAYMENT",c.dollars(this.AFTER_TAX_NET_PAYMENT,2),d);if(this.PAYMENT_OPTION==KJE.PaymentOptionsCalc.TRADITIONAL){d=KJE.replace("PAYMENT_OPTION",KJE.PaymentOptionsCalc.MSG_PAYMENT_CHOICE[this.PAYMENT_OPTION],d)}else{if(this.PAYMENT_OPTION==KJE.PaymentOptionsCalc.PERCENT_INTEREST&&KJE.PaymentOptionsCalc.INTEREST_ONLY!=null){d=KJE.replace("PAYMENT_OPTION",KJE.PaymentOptionsCalc.INTEREST_ONLY,d)}else{d=KJE.replace("PAYMENT_OPTION","PERCENT_PAYMENT "+KJE.PaymentOptionsCalc.MSG_PAYMENT_CHOICE[this.PAYMENT_OPTION],d)}}d=KJE.replace("PERCENT_PAYMENT",c.number(this.PERCENT_PAYMENT,1),d);d=KJE.replace("ENDING_BALANCE",c.dollars(this.ENDING_BALANCE,2),d);d=KJE.replace("INTEREST_PAID",c.dollars(this.INTEREST_PAID,2),d);d=KJE.replace("TOTAL_OF_PAYMENTS",c.dollars(this.TOTAL_OF_PAYMENTS,2),d);d=KJE.replace("PURCHASE_PRICE",c.dollars(this.PURCHASE_PRICE,2),d);d=KJE.replace("AMOUNT_DOWN_PAYMENT",c.dollars(this.AMOUNT_DOWN_PAYMENT,2),d);d=KJE.replace("PERCENT_DOWN_PAYMENT",c.percent(this.PERCENT_DOWN_PAYMENT/100),d);d=d.replace("**REPEATING GROUP**",this.sSchedule.getRepeat());this.sSchedule.clearRepeat();return d};KJE.Default.PREPAY_NONE=0;KJE.Default.PREPAY_WEEKLY=1;KJE.Default.PREPAY_BIWEEKLY=2;KJE.Default.PREPAY_2XMONTHLY=3;KJE.Default.PREPAY_MONTHLY=4;KJE.Default.PREPAY_YEARLY=5;KJE.Default.PREPAY_ONETIME=6;KJE.Default.PREPAY_FREQUENCY=[0,52,26,24,12,1,0];KJE.Default.getPrepayDrop=function(c,b,g){KJE.Default.PREPAY_PERIOD_IDs=KJE.parameters.get("ARRAY_PREPAY_PERIOD_ID",[KJE.Default.PREPAY_NONE,KJE.Default.PREPAY_MONTHLY,KJE.Default.PREPAY_YEARLY,KJE.Default.PREPAY_ONETIME]);KJE.Default.PREPAY_PERIODS=KJE.parameters.get("ARRAY_PREPAY_PERIODS",[KJE.parameters.get("MSG_PREPAY_NONE","none"),"Weekly","bi-weekly","semi-monthly",KJE.parameters.get("MSG_PREPAY_MONTHLY","monthly"),KJE.parameters.set("MSG_PREPAY_YEARLY","yearly"),KJE.parameters.get("MSG_PREPAY_ONETIME","one-time")]);var a=KJE.Default.PREPAY_PERIOD_IDs;var f=a.length;var e=KJE.Default.PREPAY_PERIODS;var d=new Array(f);for(i=0;i<f;i++){d[i]=e[a[i]]}return KJE.getDropBox(c,KJE.parameters.get(c,(!b?KJE.Default.PAY_LOAN_IDs:b)),a,d,g)};KJE.PaymentOptionsCalc.TRADITIONAL=0;KJE.PaymentOptionsCalc.PERCENT_INTEREST=1;KJE.PaymentOptionsCalc.PERCENT_BALANCE=2;KJE.PaymentOptionsCalc.MSG_PAYMENT_CHOICE=KJE.parameters.get("ARRAY_PAYMENT_CHOICE",["fixed term loan","% of interest owed","% of balance"]);KJE.PaymentOptionsCalc.MSG_TYPE_LABEL=KJE.parameters.get("ARRAY_TYPE_LABEL",["loan","line of credit","line of credit"]);KJE.PaymentOptionsCalc.MSG_TYPE_TEXT=KJE.parameters.get("ARRAY_TYPE_TEXT",["This payment is for a total of TERM months at INTEREST_RATE APR.","This payment is for a line of credit with an APR of INTEREST_RATE.","This payment is for a line of credit with an APR of INTEREST_RATE."]);KJE.CalcName="Loan & Credit Line Payment";KJE.CalcType="paymentoptions";KJE.CalculatorTitleTemplate="KJE1";KJE.parseInputs=function(a){var j=KJE.parameters.get("PAYMENT_PERCENT_PRINCIPAL1",5);var h=KJE.parameters.get("PAYMENT_PERCENT_PRINCIPAL2",5.5);var g=KJE.parameters.get("PAYMENT_PERCENT_PRINCIPAL3",6);var c=KJE.parameters.get("PAYMENT_PERCENT_INTEREST",100);var e=0;KJE.PaymentOptionsCalc.PERCENT_INTEREST=1;KJE.PaymentOptionsCalc.PERCENT_BALANCE=2;KJE.Default.PAYMENT_OPTION=new Array();KJE.Default.PAYMENT_PERCENT=new Array();var b=KJE.parameters.get("SHOW_FIXED_LOAN",true);var l=new Array();var k=new Array();var f=-1;if(b){l[++f]=KJE.PaymentOptionsCalc.MSG_PAYMENT_CHOICE[0];KJE.Default.PAYMENT_OPTION[f]=KJE.PaymentOptionsCalc.TRADITIONAL;KJE.Default.PAYMENT_PERCENT[f]=0;k[f]=f}if(c>0){l[++f]=KJE.parameters.get("MSG_PAYMENT_PERCENT_INTEREST",KJE.number(c,0)+KJE.PaymentOptionsCalc.MSG_PAYMENT_CHOICE[1]);KJE.Default.PAYMENT_OPTION[f]=KJE.PaymentOptionsCalc.PERCENT_INTEREST;KJE.Default.PAYMENT_PERCENT[f]=c;k[f]=f}if(j>0){l[++f]=KJE.number(j,1)+KJE.PaymentOptionsCalc.MSG_PAYMENT_CHOICE[2];KJE.Default.PAYMENT_OPTION[f]=KJE.PaymentOptionsCalc.PERCENT_BALANCE;KJE.Default.PAYMENT_PERCENT[f]=j;k[f]=f}if(h>0){l[++f]=KJE.number(h,1)+KJE.PaymentOptionsCalc.MSG_PAYMENT_CHOICE[2];KJE.Default.PAYMENT_OPTION[f]=KJE.PaymentOptionsCalc.PERCENT_BALANCE;KJE.Default.PAYMENT_PERCENT[f]=h;k[f]=f}if(g>0){l[++f]=KJE.number(g,1)+KJE.PaymentOptionsCalc.MSG_PAYMENT_CHOICE[2];KJE.Default.PAYMENT_OPTION[f]=KJE.PaymentOptionsCalc.PERCENT_BALANCE;KJE.Default.PAYMENT_PERCENT[f]=g;k[f]=f}a=KJE.replace("**PAYMENT_OPTION**",KJE.getDropBox("PAYMENT_OPTION",1,k,l),a);if(KJE.Default.getPrepayDrop){a=KJE.replace("**PREPAY_TYPE**",KJE.Default.getPrepayDrop("PREPAY_TYPE",KJE.Default.PREPAY_NONE),a)}return a};KJE.initialize=function(){KJE.CalcControl=new KJE.PaymentOptionsCalc();KJE.GuiControl=new KJE.PaymentOptions(KJE.CalcControl)};KJE.PaymentOptions=function(h){var g=KJE;var e=KJE.gLegend;var b=KJE.inputs.items;this.MSG_GRAPH3=KJE.parameters.get("MSG_GRAPH3","Balance by year");this.MSG_GRAPH4=KJE.parameters.get("MSG_GRAPH4","Balance by payment");this.MSG_GRAPH6=KJE.parameters.get("MSG_GRAPH6","Year Number");this.MSG_GRAPH7=KJE.parameters.get("MSG_GRAPH7","Payment Number");this.CALC_DOWNPAYMENT=KJE.parameters.get("CALC_DOWNPAYMENT",false);KJE.DollarSlider("MONTHLY_PAYMENT","Monthly payment",0,100000,2,1,0);KJE.PercentSlider("INTEREST_RATE","Interest rate",0,25,3);KJE.NumberSlider("TERM","Term in months",1,360,0);KJE.DollarSlider("LOAN_AMOUNT","Loan amount",100,5000000,0,1,4);KJE.DropBox("PAYMENT_OPTION","Payment option",null,null,"bold");KJE.Label("TOTAL_OF_PAYMENTS","Total payments",null,null,"KJEBold");KJE.Label("INTEREST_PAID","Total interest paid",null,null,"KJEBold");KJE.Label("ENDING_BALANCE","Ending balance",null,null,"KJEBold");KJE.Radioboxes("PAYMENT_CALC","Calculate",true,"Payment","Loan Amount","bold");var a=KJE.gNewGraph(KJE.gCOLUMN,"GRAPH1",true,false,KJE.colorList[1],KJE.parameters.get("MSG_GRAPH5","Principal Balances"));a._legend.setVisible(false);a._legend._iOrientation=(e.GRID_TOP_RIGHT);a._titleXAxis.setText(KJE.parameters.get("MSG_GRAPH1","Payment Number"));var f=KJE.parameters.get("MSG_DROPPER_TITLE","Loan & Credit Line Inputs:");var d=KJE.parameters.get("MSG_DROPPER_CLOSETITLE","Total savings KJE1");var c=function(){return f};KJE.addDropper(new KJE.Dropper("INPUTS",true,c,c),KJE.colorList[0])};KJE.PaymentOptions.prototype.setValues=function(b){var a=KJE.inputs.items;b.PAYMENT_CALC=a.PAYMENT_CALC.getValue();if(b.PAYMENT_CALC){a.MONTHLY_PAYMENT.disable();a.LOAN_AMOUNT.enable()}else{a.MONTHLY_PAYMENT.enable();a.LOAN_AMOUNT.disable()}b.INTEREST_RATE=a.INTEREST_RATE.getValue();b.TERM=a.TERM.getValue();b.LOAN_AMOUNT=a.LOAN_AMOUNT.getValue();b.MONTHLY_PAYMENT=a.MONTHLY_PAYMENT.getValue();b.PAYMENT_SELECTION=a.PAYMENT_OPTION.getValue();b.PAYMENT_OPTION=KJE.Default.PAYMENT_OPTION[b.PAYMENT_SELECTION];b.PERCENT_PAYMENT=KJE.Default.PAYMENT_PERCENT[b.PAYMENT_SELECTION]};KJE.PaymentOptions.prototype.refresh=function(e){var d=KJE;var c=KJE.gLegend;var b=KJE.inputs.items;var a=KJE.gGraphs[0];KJE.setTitleTemplate(e.MSG_TITLE);a.removeAll();a.setGraphCategories(e.cats);if(e.TERM>120){a.add(new KJE.gGraphDataSeries(e.DS_BALANCE,this.MSG_GRAPH3,a.getColor(1)))}else{a.add(new KJE.gGraphDataSeries(e.DS_BALANCE,this.MSG_GRAPH4,a.getColor(1)))}if(e.TERM>120){a._titleXAxis.setText(this.MSG_GRAPH6)}else{a._titleXAxis.setText(this.MSG_GRAPH7)}a.paint();b.LOAN_AMOUNT.setValue(e.LOAN_AMOUNT,true);b.MONTHLY_PAYMENT.setValue(e.MONTHLY_PAYMENT,true);b.TOTAL_OF_PAYMENTS.setText(d.dollars(e.TOTAL_OF_PAYMENTS,2));b.INTEREST_PAID.setText(d.dollars(e.INTEREST_PAID,2));b.ENDING_BALANCE.setText(d.dollars(e.ENDING_BALANCE,2))};KJE.InputScreenText=" <div id=KJE-D-INPUTS><div id=KJE-P-INPUTS>Input information:</div></div> <div id=KJE-E-INPUTS > <div id='KJE-C-PAYMENT_CALC'><fieldset id='KJE-FS-PAYMENT_CALC'><input id='KJE-PAYMENT_CALC1' type=radio name=PAYMENT_CALC /><input id='KJE-PAYMENT_CALC2' type=radio name=PAYMENT_CALC /></fieldset></div> <div id='KJE-C-PAYMENT_OPTION'>**PAYMENT_OPTION**</div> <div id='KJE-C-MONTHLY_PAYMENT'><input id='KJE-MONTHLY_PAYMENT' /></div> <div id='KJE-C-LOAN_AMOUNT'><input id='KJE-LOAN_AMOUNT' /></div> <div id='KJE-C-TERM'><input id='KJE-TERM' /></div> <div id='KJE-C-INTEREST_RATE'><input id='KJE-INTEREST_RATE' /></div> <div id='KJE-C-ENDING_BALANCE'><div id='KJE-ENDING_BALANCE'></div></div> <div id='KJE-C-INTEREST_PAID'><div id='KJE-INTEREST_PAID'></div></div> <div id='KJE-C-TOTAL_OF_PAYMENTS'><div id='KJE-TOTAL_OF_PAYMENTS'></div></div> <div style=\"height:10px\"></div> </div> **GRAPH1** ";KJE.DefinitionText=" <div id='KJE-D-LOAN_AMOUNT' ><dt>Loan amount</dt><dd>Total dollar amount of your loan.</dd></div> <div id='KJE-D-INTEREST_RATE' ><dt>Interest rate</dt><dd>The annual interest rate, often called an annual percentage rate (APR) for this loan or line of credit.</dd></div> <div id='KJE-D-MONTHLY_PAYMENT' ><dt>Monthly payment</dt><dd>Monthly principal and interest payment (PI) for this loan or line of credit.</dd></div> <div id='KJE-D-TERM' ><dt>Term in months</dt><dd>Number of months for this loan or line of credit.</dd></div> <div id='KJE-D-PAYMENT_OPTION' ><dt>Payment options</dt><dd>Select the option that matches your payment type: <ul><li><span class=\"KJEBold\">Fixed loan term</span><br>Traditional amortization produces a fixed monthly payment. The monthly payment calculated will leave a zero balance at the end of the loan's term.<p></p> <li><span class=\"KJEBold\">2%, 1.5% or 1% of balance</span><br>Your minimum payment is calculated as a percentage of the outstanding principal balance. Your minimum payment will change each month, and if you only make the minimum payment your balance will not be zero at the end of your loan's term.<p></p> <li><span class=\"KJEBold\">100% of interest owed</span><br>For lines paying interest owed, your payment is 100% of the interest accrued during the month but no principal. Your payment may not be fixed if your interest rate or principal balance changes. </ul> </dd></div> ";KJE.ReportText=' <!--HEADING "Loan & Credit Line Payments" HEADING--> <h2 class=\'KJEReportHeader KJEFontHeading\'>Your first monthly payment will be MONTHLY_PAYMENT.</h2> This payment is for a LOAN_AMOUNT LOAN_TYPE_LABEL. LOAN_TYPE_MSG **GRAPH** <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Loan summary</caption> <tfoot class=\'KJEReportTFooter\'> <tr class=KJEFooterRow><th class="KJELabel KJECellBorder KJECell50" scope=\'row\'>Total payments</th><td class="KJELabel KJECell50">TOTAL_OF_PAYMENTS</b> </td></tr> <tr class=KJEFooterRow><th class="KJELabel KJECellBorder KJECell50" scope=\'row\'>Total interest</th><td class="KJELabel KJECell50">INTEREST_PAID</b> </td></tr> <tr class=KJEFooterRow><th class="KJELabel KJECellBorder KJECell50" scope=\'row\'>Ending balance</th><td class="KJELabel KJECell50">ENDING_BALANCE</b> </td></tr> </tfoot> <tbody class=\'KJEReportTBody\'> <tr class=KJEOddRow><th class="KJELabel KJECellBorder KJECell50" scope=\'row\'>Payment option</th><td class="KJECell KJECell50">PAYMENT_OPTION </td></tr> <tr class=KJEOddRow><th class="KJELabel KJECellBorder KJECell50" scope=\'row\'>1st monthly payment</th><td class="KJECell KJECell50">MONTHLY_PAYMENT </td></tr> <tr class=KJEOddRow><th class="KJELabel KJECellBorder KJECell50" scope=\'row\'>Loan amount</th><td class="KJECell KJECell50">LOAN_AMOUNT </td></tr> <tr class=KJEOddRow><th class="KJELabel KJECellBorder KJECell50" scope=\'row\'>Annual Percentage Rate</th><td class="KJECell KJECell50">INTEREST_RATE </td></tr> <tr class=KJEOddRow><th class="KJELabel KJECellBorder KJECell50" scope=\'row\'>Term</th><td class="KJECell KJECell50">TERM months </td></tr> </tbody> </table></div> <h2 class=\'KJEScheduleHeader KJEFontHeading\'>Payment Schedule</h2> **REPEATING GROUP** ';